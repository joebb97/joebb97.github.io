<!DOCTYPE html>
<html lang="en-us">
<head>
    
        
<meta charset="utf-8">
<meta name="HandheldFriendly" content="True">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer-when-downgrade">

<title>A Python Oddity</title>
<meta name="description" content="Joey&#39;s Personal Website/Blog">

<link rel="alternate" type="application/rss+xml" title="RSS" href="https://www.josephbuiteweg.com/rss/">

<link rel="icon" type="image/x-icon" href="https://www.josephbuiteweg.com/favicon.ico">
<link rel="apple-touch-icon-precomposed" href="https://www.josephbuiteweg.com/favicon.png">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<link rel="stylesheet" href="https://www.josephbuiteweg.com/css/style.css?rnd=1655410259" />
<link href="https://fonts.googleapis.com/css?family=Roboto:100" rel="stylesheet">







    
</head>
<body>
    <div class="container">
        <header class="site-header">
            
                <nav class="navbar navbar-expand">
    <a class="navbar-brand" href="https://www.josephbuiteweg.com/">Joey Buiteweg</a>
    <div class="navbar-collapse">
        <ul class="navbar-nav ml-auto">
            
            
            <li class="nav-item"><a class="nav-link" href="/blog/" title="">Blog</a></li>
            
            <li class="nav-item"><a class="nav-link" href="/projects/" title="">Projects</a></li>
            
            <li class="nav-item"><a class="nav-link" href="/music/" title="">Music</a></li>
            
            <li class="nav-item"><a class="nav-link" href="/contact/" title="">Contact</a></li>
            
        </ul>
    </div>
</nav>

            
        </header>
        <main>
            

    <article class="post">
        <header class="mt-4 text-center" >
            <h1 class="post-title">A Python Oddity</h1>
            <div class="article-info">
    
    by Joey Buiteweg
    
        <div class="article-date">
            Last updated
            2021-10-11
        </div>
    
    
    
    <div class="article-taxonomies">
        
            <span class="article-categories">
                Categories: 
                
                    <a href="https://www.josephbuiteweg.com/categories/python">python</a>
                
            </span>
            
            
    </div>
</div>

            <hr>
        </header>
        

        <div class="content">
            <h2 id="the-oddity">The Oddity</h2>
<p>Let&rsquo;s say you want to intialize a matrix (a two-dimensional <code>list</code>) in python. It&rsquo;ll be an NxN matrix of numbers. Just for fun we&rsquo;ll make all the inital elements <code>1</code>, instead of <code>0</code>.</p>
<p>One might think the following would be a sensible one-liner.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span><span style="color:#6272a4"># sample.py</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">print_mat</span>(matrix):
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> row <span style="color:#ff79c6">in</span> matrix:
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">print</span>(row)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>matrix <span style="color:#ff79c6">=</span> [[<span style="color:#bd93f9">1</span>] <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">10</span>] <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">10</span>
</span></span><span style="display:flex;"><span>print_mat(matrix)
</span></span></code></pre></div><p>prints</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ python3 sample.py 
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span></code></pre></div><p><strong>But</strong>, what happens if we modify part of the matrix?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span><span style="color:#6272a4"># sample.py</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># same print_mat as above</span>
</span></span><span style="display:flex;"><span>matrix <span style="color:#ff79c6">=</span> [[<span style="color:#bd93f9">1</span>] <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">10</span>] <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">10</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;--- BEFORE MOD ---&#34;</span>)
</span></span><span style="display:flex;"><span>print_mat(matrix)
</span></span><span style="display:flex;"><span>matrix[<span style="color:#bd93f9">0</span>][<span style="color:#bd93f9">3</span>] <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">89</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>()
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;--- AFTER MOD ---&#34;</span>)
</span></span><span style="display:flex;"><span>print_mat(matrix)
</span></span></code></pre></div><p>prints</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ python3 sample.py
</span></span><span style="display:flex;"><span>--- BEFORE MOD ---
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>--- AFTER MOD ---
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 89, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 89, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 89, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 89, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 89, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 89, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 89, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 89, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 89, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 89, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span></code></pre></div><p>Oops! That clearly creates a list containing ten of the same list.</p>
<p><em>(If you are confused, we would normally expect <strong>only</strong> the first row to have been modified to have the <code>89</code>, not all of the rows)</em></p>
<h2 id="explanation">Explanation</h2>
<p>To better illustrate what&rsquo;s going on, the above declaration of matrix</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span>matrix <span style="color:#ff79c6">=</span> [[<span style="color:#bd93f9">1</span>] <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">10</span>] <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">10</span>
</span></span></code></pre></div><p>is really the same as</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span>inner_list <span style="color:#ff79c6">=</span> [<span style="color:#bd93f9">1</span>] <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">10</span>
</span></span><span style="display:flex;"><span>matrix <span style="color:#ff79c6">=</span> [inner_list] <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">10</span>
</span></span></code></pre></div><p>Since python variables are really just pointers to objects, we&rsquo;re making a list of ten of the same pointer to one object, in this case our <code>list</code> of ten ones.</p>
<h2 id="the-correct-way">The Correct Way</h2>
<p>It&rsquo;s pretty straight forward to fix this, we just use a list comprehension instead of the <code>*</code> shorthand, which produces this unexpected behavior when applied to a list of lists.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span><span style="color:#6272a4"># sample.py</span>
</span></span><span style="display:flex;"><span>matrix <span style="color:#ff79c6">=</span> [[<span style="color:#bd93f9">1</span>] <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">10</span> <span style="color:#ff79c6">for</span> _ <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">10</span>)]
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;--- BEFORE MOD ---&#34;</span>)
</span></span><span style="display:flex;"><span>print_mat(matrix)
</span></span><span style="display:flex;"><span>matrix[<span style="color:#bd93f9">0</span>][<span style="color:#bd93f9">3</span>] <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">89</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>()
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;--- AFTER MOD ---&#34;</span>)
</span></span><span style="display:flex;"><span>print_mat(matrix)
</span></span></code></pre></div><p>which produces the expected output</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ python3 sample.py
</span></span><span style="display:flex;"><span>--- BEFORE MOD ---
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>--- AFTER MOD ---
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 89, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>1, 1, 1, 1, 1, 1, 1, 1, 1, 1<span style="color:#ff79c6">]</span>
</span></span></code></pre></div><p><em>Note: we could also say</em>
<code>matrix = [[1 for _ in range(10)] for _ in range(10)]</code><em>, but that is more to type!</em></p>

        </div>
    </article>
    


        </main>
        <footer>
            
                <hr></hr>
<div class="container mb-4">
    <div class="row">
        <div class="col pl-0">
            © Joey Buiteweg, 2022
            <br>
            <span>
             <a target="_blank" rel="noopener" href="https://gohugo.io/">Hugo</a>
            </span>
        </div>
        <div class="col text-right pr-0">
                <a href="https://www.josephbuiteweg.com/contact/">Contact</a>
                <br>
                <a href="https://www.josephbuiteweg.com/extra/misc/">Misc</a>
        </div>
    </div>
</div>

            
        </footer>
    </div>
</body>
</html>
